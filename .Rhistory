source("https://raw.githubusercontent.com/julbautista/Startup/master/julian_startup.R")
df <- df[df$Year != 2003,]
df <- df[df$State != "Andaman & Nicobar Islands"
& df$State != "Dadra & Nagar Haveli"
& df$State != "Daman & Diu"
& df$State != "Lakshadweep"
& df$State != "Chandigarh",]
df <- read.csv("https://raw.githubusercontent.com/alexpavlakis/india_project/master/Julian_Final_Form.csv", header = T, skip = 2)
df <- df[df$Year != 2003,]
df <- df[df$State != "Andaman & Nicobar Islands"
& df$State != "Dadra & Nagar Haveli"
& df$State != "Daman & Diu"
& df$State != "Lakshadweep"
& df$State != "Chandigarh",]
df$State <- as.character(df$State)
df$State[df$State == "Odisha"] <- "Orissa"
df$State[df$State == "Chhatisgarh"] <- "Chhattisgarh"
pop <- read.csv("https://raw.githubusercontent.com/alexpavlakis/india_project/master/population.csv", header = TRUE)
pop <- pop[pop$State != "Andaman and Nicobar Islands"
& pop$State != "Dadra and Nagar Haveli"
& pop$State != "Daman and Diu"
& pop$State != "Lakshadweep"
& pop$State != "Chandigarh",]
ind <- merge(df, pop)
pop.func <- function(year, pop2011){
pop <- NULL
pop <- ifelse(year > 2011,
pop2011*(1.0184^(year - 2011)),
ifelse(year < 2011,
pop2011*((1/1.0184)^(2011 - year)),
pop2011))
return(pop)
}
ind$population <- pop.func(ind$Year, ind$X2011pop)
ind <- ind[,-8]
ind$exp.rup <- NULL
for(i in 1:length(ind[,1])){
ind$exp.rup[i] <- ifelse(ind$Units[i] == "Lakh",
ind$Health.Exp[i]*100000,
ind$Health.Exp[i]*1000000)
}
ind$percap <- ind$exp.rup/ind$population
ind$fm.imr <- ind$Female/ind$Male
summary(lm(fm.imr ~ percap,
data = ind))
ind <- ind[order(ind$Year),]
ind <- within(ind, state.id <- match(State, unique(State)))
ind <- within(ind, year.id <- match(Year, unique(Year)))
ind <- within(ind, year.id <- match(Year, unique(Year)))
#Plot per cap health exp by state over time
par(mfrow = c(5, 6),
mar = c(1.5, 1.75, 1, 1),
mgp = c(2, .5, 0),
las = 1,
cex = 0.6)
for(i in 1:30){
plot(ind$Year[ind$state.id == i],
ind$percap[ind$state.id == i],
type = "l",
ylim = c(0, 3000),
yaxt = "n",
xaxt = "n",
xlab = "year",
main = paste(unique(ind$State[ind$state.id == i])),
cex.main = 0.9)
axis(1, at = c(2005, 2012),
lwd = 0.5,
cex.axis = 0.6)
axis(2, at = c(0, 3000),
lwd = 0.5,
cex.axis = 0.6)
title(ylab = "IMR",
line=0, cex.lab= .6)
title(xlab = "yr",
line=0, cex.lab= .6)
}
par(mfrow = c(5, 6),
mar = c(1.5, 1.75, 1, 1),
mgp = c(2, .5, 0),
las = 1,
cex = 0.8)
for(i in 1:30){
plot(ind$Year[ind$state.id == i],
ind$Male[ind$state.id == i],
type = "l",
ylim = c(0, max(ind$Male)),
yaxt = "n", xaxt = "n",
main = paste(unique(ind$State[ind$state.id == i])),
cex.main = 0.9)
axis(1, at = c(2005, 2012),
lwd = 0.5,
cex.axis = 0.6)
axis(2, at = c(0, 75),
lwd = 0.5,
cex.axis = 0.6)
}
