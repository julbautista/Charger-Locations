source("https://raw.githubusercontent.com/julbautista/Startup/master/julian_startup.R")
setwd("C:/Users/Julian Bautista/Documents/Portfolio/Charger Locations")
supercharger <- read.csv("supercharger.csv", header = TRUE)
rem <- supercharger$Remoteness
use <- supercharger$Usage
df <- data.frame(rem,use)
ggplot(df,aes(rem, use)) + jbplot  +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.7) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf")
781/406
ggsave("ols.pdf", width = 8.5, length = 11)
ggsave("ols.pdf", width = 11, height = 8.5)
ggsave("ols.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use)) + jbplot  +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 1.5) +
geom_smooth(method= 'lm', alpha = 0.2)
ggplot(df,aes(rem, use)) + jbplot  +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 1) +
geom_smooth(method= 'lm', alpha = 0.2)
ggplot(df,aes(rem, use)) + jbplot  +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
theme_set( theme_grey() +
theme(plot.background = element_blank(),
#axis lines
axis.line = element_line(colour = "#BCBCBC", size = 1),
axis.ticks = element_blank(),
#panel
panel.background = element_rect(fill = NA, colour = NA),
panel.grid.major = element_line(colour = "light grey", size = 0.2),
panel.grid.minor = element_blank(),
#text
axis.text = element_text(colour = "grey", family = "Open Sans Light"),
axis.title = element_text(colour = "dark grey", family = "Open Sans Light"),
plot.title = element_text(hjust = 0.5, colour = "dark grey", family = "Open Sans"),
legend.text = element_text(colour = "dark grey", family = "Open Sans Light"),
#legend
legend.key = element_blank()
))
ggplot(df,aes(rem, use))  +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
public <- theme(
axis.text = element_text(colour = "grey", family = "Open Sans Light"),
axis.title = element_text(colour = "dark grey", family = "Open Sans Light", size = 18),
plot.title = element_text(hjust = 0.5, colour = "dark grey", family = "Open Sans", size = 24),
legend.text = element_text(colour = "dark grey", family = "Open Sans Light", size = 14)
)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression")
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
public <- theme(
axis.text = element_text(colour = "grey", family = "Open Sans Light"),
axis.title = element_text(colour = "dark grey", family = "Open Sans Light", size = 18),
plot.title = element_text(hjust = 0.5, colour = "dark grey", family = "Open Sans", size = 36),
legend.text = element_text(colour = "dark grey", family = "Open Sans Light", size = 14)
)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
public <- theme(
axis.text = element_text(colour = "grey", family = "Open Sans Light", size = 12),
axis.title = element_text(colour = "dark grey", family = "Open Sans Light", size = 18),
plot.title = element_text(hjust = 0.5, colour = "dark grey", family = "Open Sans", size = 36),
legend.text = element_text(colour = "dark grey", family = "Open Sans Light", size = 14)
)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
public <- theme(
axis.text = element_text(colour = "grey", family = "Open Sans Light", size = 10),
axis.title = element_text(colour = "dark grey", family = "Open Sans Light", size = 18),
plot.title = element_text(hjust = 0.5, colour = "dark grey", family = "Open Sans", size = 36),
legend.text = element_text(colour = "dark grey", family = "Open Sans Light", size = 14)
)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use))  +  public + ggtitle("OLS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'lm', alpha = 0.2)
ggsave("ols.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use)) + public +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method ='loess', alpha = 0.2)
ggsave("loess.pdf", width = 17, height = 8.5)
#initial look with convex hull to create shape around the instance space
ggplot(df,aes(rem, use)) + public +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_polygon(data = df[chull(df$rem,df$use),], fill = "light blue", alpha = 0.2) +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'loess', alpha = 0)
ggsave("hull.pdf", width = 17, height = 8.5)
#fit stan model
stanc("Charger.stan")$status
fit <- stan("Charger.stan",
data = c("rem","use"),
iter = 2000, chains = 4)
beep(1)
#create new dataframe
use_est<-colMeans(extract(fit)$use_est)
df <- data.frame(use,use_est)
#plot of the prediction vs the real data
ggplot(df) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(aes(rem,use), size = 1) +
geom_line(aes(rem,use), colour = jbpal$green) +
geom_line(aes(rem,use_est), size = 1)
#add upper and lower bound to df
lowbound <- apply(extract(fit)$use_est, 2, quantile, prob = 0.025)
upbound <- apply(extract(fit)$use_est, 2, quantile, prob = 0.975)
df <- data.frame(rem,use,use_est,lowbound,upbound)
#plot of 95% interval of usage
ggplot(df) + public +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.85) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.7)
ggsave("teslamodel.pdf", width = 17, height = 8.5)
#pinpointing greatest distance where 5% usage is near certain
ggplot(df) +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 53) +
geom_point(aes(x = 53, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 38, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use)) + public + ggtitle("LOESS Regression")
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method ='loess', alpha = 0.2)
ggsave("loess.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use)) + public + ggtitle("LOESS Regression") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method ='loess', alpha = 0.2)
ggsave("loess.pdf", width = 17, height = 8.5)
ggplot(df,aes(rem, use)) + public + ggtitle("Shrinking Variance on LOESS") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_polygon(data = df[chull(df$rem,df$use),], fill = "light blue", alpha = 0.2) +
geom_point(size = 1.9, alpha = 0.85) +
geom_smooth(method= 'loess', alpha = 0)
ggsave("hull.pdf", width = 17, height = 8.5)
ggplot(df) + public + ggtitle("Beta Distribution Model") +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.85) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.7)
ggsave("teslamodel.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 53) +
geom_point(aes(x = 53, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 38, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 53) +
geom_point(aes(x = 53, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 38, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 55) +
geom_point(aes(x = 55, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 38, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 38, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_tex
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4) +
geom_text(aes(x = 41, y = 0.03), label = "5% Min Usage Rate", colour = jbpal$brown, size = 2.5)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4)
)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4)
)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4))
)
ggplot(df) + ggtitle("Find Minimum Distance to Achieve 5% Usage Rate") + public +
theme(panel.grid.major = element_blank(), axis.ticks = element_line(colour = "#BCBCBC")) +
xlab("Distance from Nearest Major City") + ylab("Usage Rate by Owners in Nearest City") +
geom_ribbon(aes(x = rem, ymin = lowbound, ymax = upbound), alpha = 0.14) +
geom_line(aes(x = rem, y = use_est), size = 0.75, alpha = 0.25) +
geom_point(aes(rem,use), size = 1.9, alpha = 0.85) +
geom_line(aes(x = rem, y = lowbound), size = 0.75) +
geom_hline(yintercept = 0.05) +
geom_vline(xintercept = 56) +
geom_point(aes(x = 56, y = 0.05), colour = jbpal$red, size = 2.4)
ggsave("fivepercent.pdf", width = 17, height = 8.5)
